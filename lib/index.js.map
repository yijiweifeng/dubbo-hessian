{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\r\n * Created by cc on 16/8/11.\r\n */\r\n'use strict';\r\n\r\nimport zookeeper from 'node-zookeeper-client';\r\nimport parser from 'java-class-parser';\r\nimport fs from 'fs';\r\nimport tool from './toolkit.js';\r\nrequire('babel-runtime/core-js/promise').default = require('bluebird');\r\nglobal.Promise = require('bluebird');\r\n\r\n\r\nexport default class {\r\n    /**\r\n     * @param json,key\r\n     *  name（app标识）,\r\n     *  zk(注册中心地址 ip:port),\r\n     *  dubbo_version(展示到注册中心的dubbo版本,默认2.8.4),\r\n     *  service_version(服务版本,默认为任意版本),\r\n     *  service_group = 'dubbo'(服务分组,默认dubbo)\r\n     *  strictString = true(是否过滤所有提交字符串中的script/frame等)\r\n     */\r\n    constructor({name, zk, connectTimeout = 1000, retries = 3, dubbo_version = '2.8.4', service_version, service_group = 'dubbo', strictString = true} = {}) {\r\n        this.client = zookeeper.createClient(zk, connectTimeout, retries);\r\n        this.name = name;\r\n        this.dubbo_version = dubbo_version;\r\n        this.service_version = service_version;\r\n        this.service_group = service_group;\r\n        this.strictString = strictString;\r\n        this.client.once('connected', () => {\r\n\r\n        });\r\n    }\r\n\r\n    async _init() {\r\n        let readdir = tool.P(fs.readdir);\r\n        let parser2 = tool.P(parser);\r\n        let domains = await readdir('./interface/domain');\r\n        this.domains = [];\r\n        this.domainFn = [];\r\n        this.dubboFace = [];\r\n        this.dubboMethods = [];\r\n        this.dubboMethodsArgsCheckFn = [];\r\n        domains.forEach((ele, index) => {\r\n            domains[index] = \"./interface/domain/\" + ele;\r\n        });\r\n        domains = await parser2(domains);\r\n        domains.keys.forEach((clzName) => {\r\n            domains.push(clzName);\r\n            let name = clzName.substr(clzName.lastIndexOf(\".\") + 1);\r\n            let fns = {};\r\n            domains[clzName].methods.forEach((method) => {\r\n                var regs = /^get(\\w*)/.exec(method.name);\r\n                if (regs !== null) {\r\n                    var type = method.ret, fn;\r\n                    switch (type) {\r\n                        case \"java.lang.String\" :\r\n                            fn = function (value) {\r\n                                if (value === null || value === undefined || value === \"null\") {\r\n                                    return null;\r\n                                }\r\n                                return tool.stringSafeChange(this.strictString, value + str);\r\n                            };\r\n                            break;\r\n                        case \"int\" :\r\n                        case \"float\" :\r\n                        case \"double\" :\r\n                        case \"long\" :\r\n                            fn = function (value) {\r\n                                if (value === \"\" || value === undefined || value === null) {\r\n                                    return 0;\r\n                                }\r\n                                return +value;\r\n                            };\r\n                            break;\r\n                        case \"java.lang.Integer\" :\r\n                        case \"java.lang.Double\" :\r\n                        case \"java.lang.Float\" :\r\n                        case \"java.lang.Long\" :\r\n                        case \"java.lang.Number\" :\r\n                            fn = function (value) {\r\n                                if (value === \"\" || value === undefined || value === null) {\r\n                                    return null;\r\n                                }\r\n                                return +value;\r\n                            };\r\n                            break;\r\n                        case \"java.math.BigDecimal\" :\r\n                            fn = function (value) {\r\n                                if (value === \"\" || value === undefined || value === null) {\r\n                                    return null;\r\n                                } else if (typeof value === \"object\") {\r\n                                    if (value.value === \"\" || value.value === undefined || value.value === null) return null;\r\n                                    else return {value: +value.value}\r\n                                } else {\r\n                                    return {value: +value}\r\n                                }\r\n                            };\r\n                            break;\r\n                        case \"boolean\" :\r\n                            fn = function (value) {\r\n                                if (value === \"\" || value === undefined || value === null) {\r\n                                    return false;\r\n                                } else if (typeof value === \"string\") {\r\n                                    return value === \"true\";\r\n                                } else {\r\n                                    return value\r\n                                }\r\n                            };\r\n                            break;\r\n                        case \"java.lang.Boolean\" :\r\n                            fn = function (value) {\r\n                                if (value === \"\" || value === undefined) {\r\n                                    return null;\r\n                                } else if (typeof value === \"string\") {\r\n                                    return value === \"true\";\r\n                                } else {\r\n                                    return value\r\n                                }\r\n                            };\r\n                            break;\r\n                        default :\r\n                            fn = function (value) {\r\n                                return value;\r\n                            };\r\n                            break;\r\n                    }\r\n                    fns[tool.firstLowCase(regs[1])] = fn;\r\n                }\r\n            });\r\n            this.domainFn.push(fns);\r\n            this.domainFn[name] = this.domainFn[domainFn.length - 1];\r\n            this.domains[name] = clzName;\r\n        });\r\n        domains = await readdir('./interface/service');\r\n        domains.forEach((ele, index) => {\r\n            domains[index] = \"./interface/service/\" + ele;\r\n        });\r\n        domains = await parser2(domains);\r\n        domains.keys.forEach((clzName) => {\r\n            var name = clzName.substr(clzName.lastIndexOf(\".\") + 1);\r\n            this.dubboFace[name] = clzName;\r\n            this.dubboMethods[name] = {};\r\n            this.dubboMethodsArgsCheckFn[name] = {};\r\n            domains[clzName].methods.forEach((method) => {\r\n                var fns = [], names = name;\r\n                method.args.forEach((el) => {\r\n                    switch (el) {\r\n                        case \"java.lang.String\" :\r\n                            fns.push(function (value) {\r\n                                if (value === null || value === undefined || value === \"null\") {\r\n                                    return null;\r\n                                }\r\n                                return tool.stringSafeChange(value + str);\r\n                            });\r\n                            break;\r\n                        case \"int\" :\r\n                        case \"float\" :\r\n                        case \"double\" :\r\n                        case \"long\" :\r\n                            fns.push(function (value) {\r\n                                return +value;\r\n                            });\r\n                            break;\r\n                        case \"java.lang.Integer\" :\r\n                        case \"java.lang.Double\" :\r\n                        case \"java.lang.Float\" :\r\n                        case \"java.lang.Long\" :\r\n                        case \"java.lang.Number\" :\r\n                            fns.push(function (value) {\r\n                                if (value !== null && value !== undefined && value !== \"\") {\r\n                                    return +value;\r\n                                }\r\n                                return null;\r\n                            });\r\n                            break;\r\n                        case \"java.math.BigDecimal\" :\r\n                            fns.push(function (value) {\r\n                                if (value === \"\" || value === undefined || value === null) {\r\n                                    return null;\r\n                                } else if (typeof value === \"object\") {\r\n                                    if (value.value === \"\" || value.value === undefined || value.value === null) return null;\r\n                                    else return {value: +value.value}\r\n                                } else {\r\n                                    return {value: +value}\r\n                                }\r\n                            });\r\n                            break;\r\n                        case \"java.lang.Boolean\" :\r\n                            fns.push(function (value) {\r\n                                if (value === \"\" || value === undefined) {\r\n                                    return null;\r\n                                } else if (typeof value === \"string\") {\r\n                                    return value === \"true\";\r\n                                } else {\r\n                                    return value\r\n                                }\r\n                            });\r\n                            break;\r\n                        default :\r\n                            var type_, isArray = false;\r\n                            if (el.indexOf(\"java.util.List\") === -1) {\r\n                                type_ = el;\r\n                            } else {\r\n                                type_ = el.match(/<(.*)>/);\r\n                                isArray = true;\r\n                                type_ !== null && (type_ = type_[1]);\r\n                            }\r\n                            if (domains.indexOf(type_) > -1) {\r\n                                if (isArray === true) {\r\n                                    fns.push(function (value) {\r\n                                        if (value !== null && value !== undefined) {\r\n                                            for (var i = 0; i < value.length; i++) {\r\n                                                if (value[i] !== null && value[i] !== undefined) {\r\n                                                    value[i] = dataCheck(value[i], null, type_);\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        return value;\r\n                                    });\r\n                                } else {\r\n                                    fns.push(function (value) {\r\n                                        if (value !== null && value !== undefined) {\r\n                                            value = dataCheck(value, null, type_);\r\n                                        }\r\n                                        return value;\r\n                                    });\r\n                                }\r\n                            } else {\r\n                                fns.push(function (value) {\r\n                                    return value;\r\n                                });\r\n                            }\r\n                            break;\r\n                    }\r\n                });\r\n                this.dubboMethodsArgsCheckFn[names][method.name] = fns;\r\n                let that = this;\r\n                this.dubboMethods[names][method.name] = function () {\r\n                    var args = Array.from(arguments);\r\n                    return new Promise(function (resolve, reject) {\r\n                        if (args.length !== that.dubboMethodsArgsCheckFn[names][method.name].length) {\r\n                            reject(\"请求:\" + names + \".\" + method.name + \"时参数不符!\");\r\n                            return;\r\n                        }\r\n                        args.forEach( (value, index) => {\r\n                            args[index] = that.dubboMethodsArgsCheckFn[names][method.name][index](value);\r\n                        });\r\n                        that.invoke(names, method.name, args).then(function (data) {\r\n                            resolve(data);\r\n                        }).catch(function (err) {\r\n                            reject(err);\r\n                        });\r\n                    });\r\n                };\r\n            });\r\n        });\r\n    }\r\n\r\n}\r\n\r\n\r\n// client = zookeeper.createClient(\"101.200.218.24:2181\", {\r\n//     connectTimeout: 1000,\r\n//     retries: 3\r\n// });\r\n//\r\n//\r\n// var to = function () {\r\n//     var service = \"com.alibaba.dubbo.monitor.MonitorService\";\r\n//     var parameters = \"parameters\";\r\n//     var result = \"result\";\r\n//     var address = \"10.0.0.17\";\r\n//     var registry = \"registry\";\r\n//     var application = \"application\";\r\n//     var username = \"username\";\r\n//     var statistics = \"statistics\";\r\n//     var collected = \"collected\";\r\n//     var routes = \"routes\";\r\n//     var overrides = \"overrides\";\r\n//     var alived = \"alived\";\r\n//     var expired = \"expired\";\r\n//     return \"consumer://\" +\r\n//         address\r\n//         + \"/\" +\r\n//         service\r\n//         + \"?category=consumers&check=false&dubbo=0.0.1-SNAPSHOT-executable&interface=\" +\r\n//         service\r\n//         + \"&pid=18175×tamp=1470913660519\";\r\n// };\r\n//\r\n// client.once('connected', function () {\r\n//     client.create(\r\n//         \"/dubbo/com.alibaba.dubbo.monitor.MonitorService/consumers/10.0.0.179\",\r\n//         new Buffer(to()),\r\n//         zookeeper.CreateMode.EPHEMERAL,\r\n//         function (error, path) {\r\n//             if (error) {\r\n//                 console.log(error.stack);\r\n//                 return;\r\n//             }\r\n//\r\n//             console.log('Node: %s is created.', path);\r\n//         }\r\n//     );\r\n//     return;\r\n//     client.mkdirp(\"/dubbo/com.alibaba.dubbo.monitor.MonitorService/consumers/10.0.0.177\", function (error, path) {\r\n//         if (error) {\r\n//             console.log(error.stack);\r\n//             return;\r\n//         }\r\n//         console.log('Node: %s is created.', path);\r\n//     });\r\n//     return;\r\n//     var obj = {\"/\": {}};\r\n//     var fn = function (p, o) {\r\n//         client.getChildren(p, function (error, children, stats) {\r\n//             children.forEach(function (ele) {\r\n//                 if (p === \"/\") {\r\n//                     o[p + decodeURIComponent(ele)] = {};\r\n//                     fn(p + ele, o[p + ele]);\r\n//                 } else {\r\n//                     o[p + \"/\" + decodeURIComponent(ele)] = {};\r\n//                     fn(p + \"/\" + ele, o[p + \"/\" + ele]);\r\n//                 }\r\n//             });\r\n//             return obj;\r\n//         });\r\n//     };\r\n//     setTimeout(function () {\r\n//         var tt = {};\r\n//         for (var i in obj[\"/\"][\"/dubbo\"]) {\r\n//             if (isnotempty(obj[\"/\"][\"/dubbo\"][i][i + \"/providers\"])) {\r\n//                 tt[i] = (obj[\"/\"][\"/dubbo\"][i]);\r\n//             }\r\n//         }\r\n//         console.log(JSON.stringify(tt));\r\n//     }, 30 * 1000);\r\n//     fn(\"/\", obj[\"/\"]);\r\n// });\r\n//\r\n//\r\n// client.connect();"]}